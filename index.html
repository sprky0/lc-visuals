<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="css/screen.css" />
</head>
<body>
<script>

(function(container){

	var rate = 1000 / 30;
	var winterval = false;
	var keys = {

		// ROMAN ALPHA
		A : 65, B : 66, C : 67, D : 68,
		E : 69, F : 70, G : 71, H : 72,
		I : 73, J : 74, K : 75, L : 76,
		M : 77, N : 78, O : 79, P : 80,
		Q : 81, R : 82, S : 83, T : 84,
		U : 85, V : 86, W : 87, X : 88,
		Y : 89, Z : 90,

		// ARROW KEYS
		LEFT : 37, UP : 38,
		RIGHT : 39, DOWN : 40,

		//  NUMERALS
		ZERO : 48, ONE : 49, TWO : 50,
		THREE : 51, FOUR : 52, FIVE : 53,
		SIX : 54, SEVEN : 55, EIGHT : 56,
		NINE : 57,

		// OTHER
		TAB : 9, SHIFT : 16, ESCAPE : 27,
		RETURN : 13, ENTER : 13,
		ALT : 18, OPTION : 18,
		COMMAND : 224, CONTROL : 17, CTRL : 17,
		DELETE : 8, SPACE : 32

	};

	function clear() {
		try {
			clearInterval(winterval);
		} catch(e) {
			// did errored
		}
		container.innerHTML = "";
	}

	function world(res_x, res_y, moder) {

		clear();

		var pointer_x = 0;
		var pointer_y = 0;

		var resolution_x = res_x || 20;
		var resolution_y = res_y || 10;
		var mode = moder || "singler";

		var life = Math.floor( Math.random() * 5000 );

		var width = window.innerWidth;
		var height = window.innerHeight;
		var pixels = {};

		function Item(element, x, y) {

			var _element = element;

			scaleTo(width / resolution_x, height / resolution_y);
			moveTo(x,y);

			function setColor(s) {
				_element.style.backgroundColor = s;
			}

			function randomColor(colors) {
				setColor( colors[Math.floor(Math.random() * colors.length) ] );
			}

			function scaleTo(w,h) {
				_element.style.width = w + "px";
				_element.style.height = h + "px";
			}

			function moveTo(x,y) {
				_element.style.left = (width / resolution_x * x) + "px";
				_element.style.top = (height / resolution_y * y) + "px";
			}

			return {
				dom : _element,
				moveTo : moveTo,
				setColor : setColor,
				randomColor : randomColor
			};

		}

		function init(callback) {

			for (var x = 0; x < resolution_x; x++) {
				for (var y = 0; y < resolution_y; y++) {
					var zitem = new Item( document.createElement("div"), x, y );
					container.appendChild( zitem.dom );
					pixels[x+"_"+y] = zitem;
					zitem.randomColor(pixels[x+"_"+y]);
				}
			}

			callback();
		}

		function randomPixel() {
			return pixels[rand(resolution_x) + "_" + rand(resolution_y)];
		}

		function clearPixels() {
			for (var x = 0; x < resolution_x; x++) {
				for (var y = 0; y < resolution_y; y++) {
					pixels[x+"_"+y].setColor("#000000");
				}
			}
		}

		function interval() {

			switch (mode) {

				default:
					for(var i = 0; i < 50; i++) {
						randomPixel().randomColor(["#ff0000","#aa0000","#cc0000","#000000","#0000aa"]);
					}
				break;

			case "vcycler":

					clearPixels();

					for (pointer_y = 0; pointer_y < resolution_y; pointer_y++) {
						pixels[pointer_x+"_"+pointer_y].setColor("#FF0000");
					}
					pointer_x ++;

					if (pointer_x >= resolution_x)
						pointer_x = 0;

					break;

				case "hcycler":

						clearPixels();

						for (pointer_x = 0; pointer_x < resolution_x; pointer_x++) {
							pixels[pointer_x+"_"+pointer_y].setColor("#FF0000");
						}
						pointer_y ++;

						if (pointer_y >= resolution_y)
							pointer_yrxlbvlvlr = 0;

						break;

				case "singler":
					clearPixels();
					for(var i = 0; i < 100; i++) {
						randomPixel().randomColor(["#ff0000","#aa0000","#cc0000","#110000","#000000"]);
					}
				break;

			}

			winterval = setTimeout(interval, rate);

		}

		init(interval);

	}

	function rand(high,low) {
		return Math.floor(Math.random() * Math.max(high,low||0) + Math.min(high,low||0));
	}

	document.addEventListener("keyup", function(e) {
		switch(e.keyCode) {

			case keys.Z:
				clear();
				break;

			case keys.X:
				world(1, 1);
				break;

			case keys.L:
				world(1, rand(200,10));
				break;

			case keys.V:
				world(rand(200,10), 1);
				break;

			case keys.R:
				// world(rand(20,1), rand(20,1), "hcycler");
				world(1, rand(20,16), "hcycler");
				break;

			case keys.ONE:
				rate = 1000 / 200;
				break;

			case keys.TWO:
				rate = 1000 / 100;
				break;

			case keys.THREE:
				rate = 1000 / 50;
				break;

			case keys.FOUR:
				rate = 1000 / 30;
				break;

			case keys.FIVE:
				rate = 1000 / 15;
				break;

			case keys.SIX:
				rate = 1000 / 8;
				break;

			case keys.SEVEN:
				rate = 1000 / 4;
				break;

			case keys.EIGHT:
				rate = 1000 / 2;
				break;

			case keys.NINE:
				rate = 1000;
				break;

			case keys.ENTER:
				fullscreen(container);
				break;

		}
	});

	function fullscreen(elem) {

		if (elem.requestFullscreen) {
			elem.requestFullscreen();
		} else if (elem.msRequestFullscreen) {
			elem.msRequestFullscreen();
		} else if (elem.mozRequestFullScreen) {
			elem.mozRequestFullScreen();
		} else if (elem.webkitRequestFullscreen) {
			elem.webkitRequestFullscreen();
		}

	}


	world(1,1,"singler");

})(document.getElementsByTagName("body")[0]);

</script>

</body>
</html>
